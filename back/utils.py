# test_l = [{
#               'video_url': 'https://www.youtube.com/watch?v=FUZoo2OZ_d0&pp=ygVRVGlrVG9rIGRyYW1hIHwgQ2VsZWJyaXR5IGNvbnRyb3ZlcnNpZXMgfCBTb2NpYWwgbWVkaWEgc2NhbmRhbHMgfCBZb3VUdWJlIGV4cG9zw6lz',
#               'thumbnail_360x202': 'https://i.ytimg.com/vi/FUZoo2OZ_d0/hq720.jpg?sqp=-oaymwEcCOgCEMoBSFXyq4qpAw4IARUAAIhCGAFwAcABBg==&rs=AOn4CLA07xFwYSf2rtVd0mOmltH2k0vnxw',
#               'thumbnail_720x404': 'https://i.ytimg.com/vi/FUZoo2OZ_d0/hq720.jpg?sqp=-oaymwEcCNAFEJQDSFXyq4qpAw4IARUAAIhCGAFwAcABBg==&rs=AOn4CLAFCMQRwO8Yne36WmsnIeGUwYw1Nw',
#               'title_text': 'The Worst Commentary Creator on YouTube',
#               'title_label': 'The Worst Commentary Creator on YouTube by Turkey Tom 2 months ago 45 minutes 1,868,836 views',
#               'channel_url': 'https://www.youtube.com/@TurkeyTom', 'channel_text': 'Turkey Tom',
#               'published_time': '2 months ago', 'video_length': '45:55', 'view_count': '1,868,836 views'}, {
#               'video_url': 'https://www.youtube.com/watch?v=89RmX-065jk&pp=ygVRVGlrVG9rIGRyYW1hIHwgQ2VsZWJyaXR5IGNvbnRyb3ZlcnNpZXMgfCBTb2NpYWwgbWVkaWEgc2NhbmRhbHMgfCBZb3VUdWJlIGV4cG9zw6lz',
#               'thumbnail_360x202': 'https://i.ytimg.com/vi/89RmX-065jk/hq720.jpg?sqp=-oaymwEcCOgCEMoBSFXyq4qpAw4IARUAAIhCGAFwAcABBg==&rs=AOn4CLBDf1vHuz1WAikLHEmOPPtZvRtsAw',
#               'thumbnail_720x404': 'https://i.ytimg.com/vi/89RmX-065jk/hq720.jpg?sqp=-oaymwEcCNAFEJQDSFXyq4qpAw4IARUAAIhCGAFwAcABBg==&rs=AOn4CLAjgOsmCRN3Zh3VGvOBfm5jvbiJmQ',
#               'title_text': 'TikToker Murdered By Rival On Livestream',
#               'title_label': 'TikToker Murdered By Rival On Livestream by Ape Huncho 7 months ago 10 minutes, 6 seconds 798,242 views',
#               'channel_url': 'https://www.youtube.com/@ApeHuncho', 'channel_text': 'Ape Huncho',
#               'published_time': '7 months ago', 'video_length': '10:06', 'view_count': '798,242 views'}, {
#               'video_url': 'https://www.youtube.com/watch?v=9xMurq8WJJA&pp=ygVRVGlrVG9rIGRyYW1hIHwgQ2VsZWJyaXR5IGNvbnRyb3ZlcnNpZXMgfCBTb2NpYWwgbWVkaWEgc2NhbmRhbHMgfCBZb3VUdWJlIGV4cG9zw6lz',
#               'thumbnail_360x202': 'https://i.ytimg.com/vi/9xMurq8WJJA/hq720.jpg?sqp=-oaymwEcCOgCEMoBSFXyq4qpAw4IARUAAIhCGAFwAcABBg==&rs=AOn4CLDjsNTMC-OLuKVudeaZJ5d6XRZ8ZQ',
#               'thumbnail_720x404': 'https://i.ytimg.com/vi/9xMurq8WJJA/hq720.jpg?sqp=-oaymwEcCNAFEJQDSFXyq4qpAw4IARUAAIhCGAFwAcABBg==&rs=AOn4CLAUCCnjzeDr8EAusRqqz2bBcywbzQ',
#               'title_text': 'The Dark Truth of SHEIN: TikTok’s TOXIC Obsession EXPOSED | Downfall',
#               'title_label': 'The Dark Truth of SHEIN: TikTok’s TOXIC Obsession EXPOSED | Downfall by SWOOP 1 month ago 1 hour, 32 minutes 574,515 views',
#               'channel_url': 'https://www.youtube.com/@PettyUniversity', 'channel_text': 'SWOOP',
#               'published_time': '1 month ago', 'video_length': '1:32:32', 'view_count': '574,515 views'}, {
#               'video_url': 'https://www.youtube.com/watch?v=I6pqZl7tMuY&pp=ygVRVGlrVG9rIGRyYW1hIHwgQ2VsZWJyaXR5IGNvbnRyb3ZlcnNpZXMgfCBTb2NpYWwgbWVkaWEgc2NhbmRhbHMgfCBZb3VUdWJlIGV4cG9zw6lz',
#               'thumbnail_360x202': 'https://i.ytimg.com/vi/I6pqZl7tMuY/hq720.jpg?sqp=-oaymwEcCOgCEMoBSFXyq4qpAw4IARUAAIhCGAFwAcABBg==&rs=AOn4CLAcpZ6dlFcS06a_BaOYlno0sfe_mg',
#               'thumbnail_720x404': 'https://i.ytimg.com/vi/I6pqZl7tMuY/hq720.jpg?sqp=-oaymwEcCNAFEJQDSFXyq4qpAw4IARUAAIhCGAFwAcABBg==&rs=AOn4CLDh8i1izXt6-55T3MIWyZPVYnl4kg',
#               'title_text': 'The History Of The Most Hated Person On Tik Tok.',
#               'title_label': 'The History Of The Most Hated Person On Tik Tok. by TheAsherShow 9 months ago 8 minutes, 7 seconds 1,892,691 views',
#               'channel_url': 'https://www.youtube.com/@TheAsherShow', 'channel_text': 'TheAsherShow',
#               'published_time': '9 months ago', 'video_length': '8:07', 'view_count': '1,892,691 views'}, {
#               'video_url': 'https://www.youtube.com/watch?v=l4yZQZf2g5Y&pp=ygVRVGlrVG9rIGRyYW1hIHwgQ2VsZWJyaXR5IGNvbnRyb3ZlcnNpZXMgfCBTb2NpYWwgbWVkaWEgc2NhbmRhbHMgfCBZb3VUdWJlIGV4cG9zw6lz',
#               'thumbnail_360x202': 'https://i.ytimg.com/vi/l4yZQZf2g5Y/hq720.jpg?sqp=-oaymwEcCOgCEMoBSFXyq4qpAw4IARUAAIhCGAFwAcABBg==&rs=AOn4CLCypGC7N8WCkwLsOhZODkkzw8z-aQ',
#               'thumbnail_720x404': 'https://i.ytimg.com/vi/l4yZQZf2g5Y/hq720.jpg?sqp=-oaymwEcCNAFEJQDSFXyq4qpAw4IARUAAIhCGAFwAcABBg==&rs=AOn4CLAc9xNO4IJwUGnmEorNO8_cmhFMQQ',
#               'title_text': 'TikTok Is Becoming Problematic',
#               'title_label': 'TikTok Is Becoming Problematic by Doctor Mike 6 months ago 8 minutes, 7 seconds 3,143,137 views',
#               'channel_url': 'https://www.youtube.com/@DoctorMike', 'channel_text': 'Doctor Mike',
#               'published_time': '6 months ago', 'video_length': '1:07', 'view_count': '3,143,137 views'}]
#

def is_short_video(video_length):
    '''
    Проверяет, является ли видео коротким (менее 1,5 минуты).
    :param video_length: строка с длительностью видео в формате HH:MM:SS или MM:SS
    :return: True, если видео короткое, иначе False
    '''
    time_parts = video_length.split(':')

    # Если у нас есть часы, минуты и секунды
    if len(time_parts) == 3:
        hours, minutes, seconds = map(int, time_parts)
    # Если у нас только минуты и секунды
    elif len(time_parts) == 2:
        hours = 0
        minutes, seconds = map(int, time_parts)
    else:
        return True  # Если формат не соответствует ожидаемому

    total_seconds = hours * 3600 + minutes * 60 + seconds

    return total_seconds < 90


def find_new_titles(video_list, channel_name):
    titles = []
    for item in video_list:
        channel_name_in_list = item['channel_url'].split('@')[-1]
        if not is_short_video(item['video_length']) and channel_name != channel_name_in_list:
            titles.append(item['title_text'])

    return titles
